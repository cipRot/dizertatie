<div ng-include src="'frontend/templates/tpl/header.html'" ng-controller="HeaderController"></div>

<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Edit user {{username}}:</h4> 
      </div>
      <div class="modal-body">
        <form id="form" class="portlet-body form">
            <div class="form-horizontal" role="form">
                <div class="form-body">   
                    <div class="form-group">
                        <label class="col-md-3 control-label">Username:</label>
                        <div class="col-md-9">
                            <input type="text" class="form-control" name="username" ng-model="username"> 
                        </div>
                    </div> 
                    <div class="form-group">
                        <label class="col-md-3 control-label">Email:</label>
                        <div class="col-md-9">
                            <input type="text" class="form-control" name="email" ng-model="email">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-3 control-label">Password:</label>
                        <div class="col-md-9">
                            <input type="password" class="form-control" name="password" ng-model="password">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-3 control-label">Confirm password:</label>
                        <div class="col-md-9">
                            <input type="password" class="form-control" name="re_password" ng-model="re_password">
                        </div>
                    </div>
                     
                    <div class="form-group">
                        <label class="col-md-3 control-label">User groups:</label>
                        <div class="col-md-9">
                            <select 
                                class="form-control" 
                                ng-model="defaultGroup" 
                                id="groups"   
                                ng-change="getGroupByID(defaultGroup)"
                                > 
                                <option 
                                    ng-repeat="group in groups track by $index" 
                                    value="{{group.id}}">
                                    {{group.name}}
                                </option>
                            </select>
                        </div>
                    </div>
                </div> 
            </div>
        </form>
      </div>
      <div class="modal-footer">
        <button
            type="button" 
            class="btn btn-default" 
            ng-click="saveChanges(username,email,password,re_password,defaultGroup)">
            Save changes
        </button> 
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<div id="addUser" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Add user details:</h4> 
      </div>
      <div class="modal-body">
        <form id="add_user_form" class="portlet-body form" ng-submit=>
            <div class="form-horizontal" role="form">
                <div class="form-body">   
                    <div class="form-group">
                        <label class="col-md-3 control-label">Username:</label>
                        <div class="col-md-9">
                            <input type="text" class="form-control" name="new_username" ng-model="new_username"> 
                        </div>
                    </div> 
                    <div class="form-group">
                        <label class="col-md-3 control-label">Email:</label>
                        <div class="col-md-9">
                            <input type="text" class="form-control" name="new_email" ng-model="new_email">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-3 control-label">Password:</label>
                        <div class="col-md-9">
                            <input type="password" class="form-control" name="new_password" id="new_password" ng-model="new_password">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-3 control-label">Confirm password:</label>
                        <div class="col-md-9">
                            <input type="password" class="form-control" name="new_re_password" ng-model="new_re_password">
                        </div>
                    </div>
                     
                    <div class="form-group">
                        <label class="col-md-3 control-label">User groups:</label>
                        <div class="col-md-9">
                            <select 
                                class="form-control" 
                                ng-model="add_Group" 
                                id="groups"    
                                > 
                                <option 
                                    ng-repeat="group in groups track by $index" 
                                    value="{{group.id}}">
                                    {{group.name}}
                                </option>
                            </select>
                        </div>
                    </div>
                </div> 
            </div>
        </form>
      </div>
      <div class="modal-footer">
        <button
            type="submit" 
            class="btn btn-default" 
            ng-click="addUser(new_username,new_email,new_password,new_re_password,add_Group)">
            Save changes
        </button> 
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>



<div class="container"> 
    <div class="row"> 
        <div class="col-md-12">
            <div class="portlet light">
                <div class="portlet-title">
                    <div class="caption">
                        <i class="icon-users"></i> Admin - Users
                    </div> 
                    <button 
                        type="button" 
                        class="btn btn-default pull-right"
                        ng-click="modal_open()"
                        ng-if="checkRole('ROLE_CREATE_ACCOUNTS')">
                        Add new user
                    </button>
                </div>
                <div class="portlet-body"> 
                    <table class="table table-bordered" id="users">
                        <thead> 
                          <tr>
                            <th style="width: 5%">ID</th> 
                            <th style="width: 20%">Username</th>
                            <th style="width: 15%">Email</th>
                            <th style="width: 10%">Last login</th> 
                            <th style="width: 10%">Status</th>
                            <th style="width: 10%">Author</th>  
                            <th style="width: 10%">Group</th>  
                            <th style="width: 20%">Actions</th>
                         </tr>    
                        </thead> 
                   </table> 

                </div>
            </div>
        </div>
 
    </div>
    
</div>